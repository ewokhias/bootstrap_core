
# --- tt_content.textpic ----------
#
tt_content.textpic.20 {
    text.wrap = <div class="textpic-text"> | </div>
}

# --- tt_content.image ----------
#

# Modified image size calculation
#
# include lib for image calculation
includeLibs.user_imgwidthcalc = typo3conf/ext/bootstrap_core/Classes/Service/ImageWidthCalculator.php

# Dynamic image width calculation based on
# - page col (or inherited col)
# - parent grid col (if exists)
# - grid col (if exists)
# - only if left/right image pos? textpic-layout (saved in imagewidth, changed "functionality")
# - and num of image cols
tt_content.image.20.1.file.width.field >
tt_content.image.20.1.file.width.cObject = USER
tt_content.image.20.1.file.width.cObject {
    # call user function
    userFunc = Simplicity\BootstrapCore\Service\ImageWidthCalculator->getImageWidth

    # template column width (for 1200px device)
    #
    beLayoutColWidth {
        # uid of backend_layout
        1 {
            # colPos = width in px
            0 = 1170
        }
        2 {
            0 = 770
            1 = 370
        }
        3 {
            0 = 770
            2 = 370
        }
        4 {
            0 = 570
            1 = 270
            2 = 270
        }
        5 {
            0 = 1170
            3 = 1150
        }
    }

    # grid elements content width
    #
    gridElementColWidth {
        # Columns
        # for column grids (1-3): auto calculation based on flexform field 'layout' and rowFluidSpanWidth

        # Special Box
        4 {
            # colPos = negative fix px for margin/padding
            101 = -20
            # colPos = fluid row span width
            #101 = 20%
            # colPos = fix width
            #101 = 1150
        }

        # Accordion
        5 {
            # colPos = negative fix px
            101 = -30
        }

        # Tabs
        6 {
            # colPos = negative fix px
            101 = -20
        }

        # Slider
        7 {
            # colPos = negative fix px
            101 = -20
        }

        # Modal
        8 {
            # colPos = fix width
            101 = 530
        }
     }


    # row fluid span width (in percentage)
    rowFluidSpanWidth {
        1 = 0.05982905982905983
        2 = 0.1452991452991453
        3 = 0.23076923076923077
        4 = 0.31623931623931625
        5 = 0.4017094017094017
        6 = 0.48717948717948715
        7 = 0.5726495726495726
        8 = 0.6581196581196582
        9 = 0.7435897435897436
        10 = 0.8290598290598291
        11 = 0.9145299145299145
        12 = 1
    }
}

# Modified image markup and classes
#
tt_content.image.20 {

    addClassesCol {
        ifEmpty = textpic-firstcol textpic-lastcol
        override = textpic-firstcol |*| |*| textpic-lastcol
    }

    addClassesImage = image-first |*| |*| image-last

    layout {
        # above center
        default.value = <div class="row-fluid textpic textpic-center textpic-above ###CLASSES###">###IMAGES###<div class="clearfix"></div>###TEXT###</div>
        # above right
        1.value = <div class="row-fluid textpic textpic-right textpic-above ###CLASSES###">###IMAGES###<div class="clearfix"></div>###TEXT###</div>
        # above left
        2.value = <div class="row-fluid textpic textpic-left textpic-above ###CLASSES###">###IMAGES###<div class="clearfix"></div>###TEXT###</div>
        # below center
        8.value = <div class="row-fluid textpic textpic-center textpic-below ###CLASSES###">###TEXT###<div class="clearfix"></div>###IMAGES###</div>
        # below right
        9.value = <div class="row-fluid textpic textpic-right textpic-below ###CLASSES###">###TEXT###<div class="clearfix"></div>###IMAGES###</div>
        # below left
        10.value = <div class="row-fluid textpic textpic-left textpic-below ###CLASSES###">###TEXT###<div class="clearfix"></div>###IMAGES###</div>

        # Intext, right
        17.value >
        17 = COA
        17.wrap = <div class="row-fluid textpic textpic-intext-right">|###TEXT###</div>
        17 {
            10 = TEXT
            10.dataWrap = <div class="span{field:tx_bootstrapcore_imageswidth} textpic-intext-images pull-right">###IMAGES###</div>
            # override if image col span > 10
            10.dataWrap.override = <div class="textpic-intext-images pull-right" style="width:{register:rowWidthPlusTextMargin}px;">###IMAGES###</div>
            10.dataWrap.override.if.value = 0
            10.dataWrap.override.if.equals.field = tx_bootstrapcore_imageswidth
        }
        # Intext, left
        18.value >
        18 < .17
        18.wrap = <div class="row-fluid textpic textpic-intext-left">|###TEXT###</div>
        18.10.dataWrap = <div class="span{field:tx_bootstrapcore_imageswidth} textpic-intext-images">###IMAGES###</div>
        18.10.dataWrap.override = <div class="textpic-intext-images pull-left" style="width:{register:rowWidthPlusTextMargin}px;">###IMAGES###</div>

        # Besides text right
        25.value >
        25 = COA
        25.wrap = <div class="row-fluid textpic textpic-rightcol">|</div>
        25 {
            5 = LOAD_REGISTER
            5 {
                TextSpanSize = TEXT
                TextSpanSize.stdWrap.dataWrap = 12-{field:tx_bootstrapcore_imageswidth}
                TextSpanSize.prioriCalc = 1
            }
            10 = TEXT
            10.dataWrap = <div class="span{register:TextSpanSize} textpic-cols-text">###TEXT###</div>
            # override if new imagewidth field not used (switch text/image!)
            10.dataWrap.override = <div class="textpic-cols-images pull-right" style="width:{register:rowwidth}px;">###IMAGES###</div>
            10.dataWrap.override.if.value = 0
            10.dataWrap.override.if.equals.field = tx_bootstrapcore_imageswidth

            20 = TEXT
            20.dataWrap = <div class="span{field:tx_bootstrapcore_imageswidth} textpic-cols-images">###IMAGES###</div>
            # override if new imagewidth field not used (switch text/image!)
            20.dataWrap.override = <div class="textpic-cols-text" style="margin-right:{register:rowWidthPlusTextMargin}px;">###TEXT###</div>
            20.dataWrap.override.if.value = 0
            20.dataWrap.override.if.equals.field = tx_bootstrapcore_imageswidth
        }

        # Besides text left
        26.value >
        26 < .25
        26.wrap = <div class="row-fluid textpic textpic-leftcol">|</div>
        26 {
            20.dataWrap.override = <div class="textpic-cols-images pull-left" style="width:{register:rowwidth}px;">###IMAGES###</div>

            30 < .10
            30.dataWrap.override = <div class="textpic-cols-text" style="margin-left:{register:rowWidthPlusTextMargin}px;">###TEXT###</div>
            10 >
        }
    }

    rendering {

        singleNoCaption {
            allStdWrap.wrap >
            allStdWrap.dataWrap = <div class="textpic-imagegrid"> | </div>
            allStdWrap.dataWrap.override >

            # always html5, override not needed
            singleStdWrap.wrap = <figure class="###CLASSES###"> | </figure>
            singleStdWrap.wrap.override >
        }

        noCaption {
            allStdWrap.wrap >
            allStdWrap.dataWrap = <div class="textpic-imagegrid"> | </div>

            noRowsStdWrap.wrap = <div class="row-fluid textpic-norows"> | </div>

            rowStdWrap.wrap = <div class="row-fluid"> | </div>
            rowStdWrap.wrap.override >
            lastRowStdWrap.wrap = <div class="row-fluid textpic-lastrow"> | </div>
            lastRowStdWrap.wrap.override >

            #columnStdWrap.wrap = <div class="spanX"> | </div>
            columnStdWrap.wrap.stdWrap.cObject = COA
            columnStdWrap.wrap.stdWrap.cObject {
                10 = TEXT
                10.stdWrap.dataWrap = 12/{field:imagecols}
                10.prioriCalc = 1
                10.wrap = <div class="span|">

                20 = TEXT
                20.value = |</div>
            }

            # always html5, override not needed
            singleStdWrap.wrap = <figure class="###CLASSES###"> | </figure>
            singleStdWrap.wrap.override >
        }

        singleCaption {
            # always html5, override not needed
            singleStdWrap.wrap = <figure class="###CLASSES###">|###CAPTION###</figure>
            singleStdWrap.wrap.override >

            caption.wrap = <figcaption class="###CLASSES###"> | </figcaption>
            caption.wrap.override >
        }

        splitCaption {
            noRowsStdWrap.wrap = <div class="row-fluid textpic-norows"> | </div>

            rowStdWrap.wrap = <div class="row-fluid"> | </div>
            rowStdWrap.wrap.override >
            lastRowStdWrap.wrap = <div class="row-fluid textpic-lastrow"> | </div>
            lastRowStdWrap.wrap.override >

            #columnStdWrap.wrap = <div class="spanX ###CLASSES###"> | </div>
            columnStdWrap.wrap.stdWrap.cObject = COA
            columnStdWrap.wrap.stdWrap.cObject {
                10 = TEXT
                10.stdWrap.dataWrap = 12/{field:imagecols}
                10.prioriCalc = 1
                10.wrap = <div class="span| ###CLASSES###">

                20 = TEXT
                20.value = |</div>
            }

            singleStdWrap.wrap = <figure class="###CLASSES###">|###CAPTION###</figure>
            singleStdWrap.wrap.override >

            caption.wrap = <figcaption class="###CLASSES###"> | </figcaption>
            caption.wrap.override >

        }
        # end splitCaption

    }
    # end rendering
}